## ชื่อโครงการ: ระบบวัดอัตราการเต้นของหัวใจ
## Link to youtube
[ระบบวัดอัตราการเต้นของหัวใจ](https://www.youtube.com/watch?v=bSlVmzA1L24)
## สมาชิกในกลุ่ม
- 64102122 จิรภัทร จิตรภักดี
- 64125354 ภีรภัทร บุญสุวรรณ
- 64104532 ณัฐนันท์ ทองมาก


## บทนำ
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;สิ่งที่สนใจของโครงงานนี้คือ การวัดและติดตามอัตราการเต้นของหัวใจด้วยการใช้ Internet of Things (IoT) ซึ่งเป็นเรื่องที่สำคัญที่เราจะต้องติดตามอัตราการเต้นหัวใจว่าอยู่ในระดับใด มีอัตตราการเต้นผิดปกติหรือไม่ซึ่งอาจก่อให้เกิดภัยใกล้ตัวได้
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ปัญหาหลักที่เราสนใจคือ การติดตามและรับรู้สถานะของอัตราการเต้นหัวใจของบุคคลในช่วงเวลาต่างๆ ทั้งผู้ที่มีปัญหาทางสุขภาพ ผู้คนทั่วไป หรือนักกีฬา ซึ่งการที่หัวใจเต้นเร็วหรือไม่สม่ำเสมอนั้น อาจนำไปสู่ “ภาวะหัวใจวาย”หรือโรคอื่นๆได้ ทางกลุ่มเราจีงได้ทำระบบตรวจวัดอัตราการเต้นของหัวใจ เพื่อให้ผู้ใช้งานได้ระวังภัยอันตรายที่อาจเกิดต่อตัวเอง
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;โครงการนี้จะมุ่งเน้นการใช้ IoT เพื่อพัฒนาระบบที่สามารถติดตามและรายงานสถานะของอัตราการเต้นของหัวใจอย่างต่อเนื่องเป็นระยะ และแสดงผลผ่านเว็บไซต์ เพื่อช่วยให้การดูแลสุขภาพนั้นเป็นไปอย่างมีประสิทธิภาพและแม่นยำ
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;วัตถุประสงค์ของโครงงานนี้ คือ เพื่อพัฒนาระบบที่ช่วยในการติดตามและรายงานข้อมูลเกี่ยวกับอัตราการเต้นหัวใจผ่าน Internet of Things (IoT) เพื่อเสริมสร้างการดูแลสุขภาพ และการเฝ้าระวังโรคที่เกี่ยวกับหัวใจอย่างมีประสิทธิภาพมากขึ้น

## การออกแบบระบบ

แสดงสถาปัตยกรรมระบบ (Systems Architecture)
![image](https://github.com/jirpathjitpakdee/IOT-MiniProject/assets/68944270/36c77ab6-e3b6-4e39-afdf-0a7cab1ab660/test1.png)

- โมดูลที่หนึ่ง Arduino UNO จะทำการอ่านค่าจากเซ็นเซอร์วัดอัตราการเต้นของหัวใจ (GY-MAX30102) และทำการ print ออกทาง Serial
- โมดูลที่สอง Arduino UNO จะส่งค่าเฉลี่ยอัตราการเต้นของหัวใจทางจอแสดงผล OLED
- โมดูลที่สาม ESP8266 ทำการอ่านค่าเฉลี่ยอัตราการเต้นของหัวใจจาก Serial จากนั้นทำการ Publish ค่าไปยัง MQTT
- โมดูลที่สี่ NodeJS ทำการ Subscribe ค่าจาก MQTT แล้วนำไปเก็บใน Json-server
- โมดูลที่ห้า ตัวเว็บไซต์จะเรียก API จาก Json-server นำข้อมูลค่าเฉลี่ยอัตราการเต้นของหัวใจมาแสดง 
- โมดูลที่หก ตัวเว็บไซต์สามารถควบการเปิด-ปิดของเซ็นเซอร์ได้ โดยการเรียก API จาก NodeJS เพื่อทำการ Publish ค่าการเปิด-ปิดเซ็นเซอร์
- โมดูลที่เจ็ด ESP8266 ทำการ Subscribe ค่าจาก MQTT จากนั้นแสดงผ่าน Serial 
- โมดูลที่แปด Arduino UNO ทำการอ่านค่าจาก Serial เพื่อควบคุมการเปิด-ปิดเว็นเซอร์ 

แสดงสถาปัตยกรรมซอฟต์แวร์ (Software Architecture)
![ang](https://github.com/jirpathjitpakdee/IOT-MiniProject/assets/68944270/62a65578-34c2-4080-b35d-e968a550ecf7/test2.png)

- โมดูลที่หนึ่ง Arduino UNO จะทำการอ่านค่าจากเซ็นเซอร์วัดอัตราการเต้นของหัวใจ (GY-MAX30102) และทำการ print ออกทาง Serial
- โมดูลที่สอง Arduino UNO จะส่งค่าเฉลี่ยอัตราการเต้นของหัวใจทางจอแสดงผล OLED
- โมดูลที่สาม ESP8266 ทำการอ่านค่าเฉลี่ยอัตราการเต้นของหัวใจจาก Serial จากนั้นทำการ Publish ค่าไปยัง MQTT ใน Topic “HR”
- โมดูลที่สี่ NodeJS ทำการ Subscribe TOpic “HR” ค่าจาก MQTT แล้วนำไปเก็บใน Json-server
- โมดูลที่ห้า ตัวเว็บไซต์จะเรียก API จาก Json-server นำข้อมูลค่าเฉลี่ยอัตราการเต้นของหัวใจมาแสดง 
- โมดูลที่หก ตัวเว็บไซต์สามารถควบการเปิด-ปิดของเซ็นเซอร์ได้ โดยการเรียก API จาก NodeJS เพื่อทำการ Publish Topic “On/Off” ค่าการเปิด-ปิดเซ็นเซอร์
- โมดูลที่เจ็ด ESP8266 ทำการ Subscribe Topic “On/Off” ค่าจาก MQTT จากนั้นแสดงผ่าน Serial 
- โมดูลที่แปด Arduino UNO ทำการอ่านค่าจาก Serial เพื่อควบคุมการเปิด-ปิดเว็นเซอร์ 

### Data Stucture
โครงสร้างข้อมูลถูกเก็บด้วย JSON โดยประกอบด้วยข้อมูลดังนี้ id,bpmAvg ดังตัวอย่างตามลำดับ ที่ถูกจัดเก็บใน Module ชื่อ data 
#### โครงสร้างข้อมูล :
```json
{
  "data": [
    {
      "bpmAvg":52,
      "id": 1
    },
    {
      "bpmAvg":80
      "id": 2
    }
  ]
}
```
### Data Dictionary
| Attribute | Description | Data Type | Example |
|--------------------|--------------------|--------------------|--------------------|
| id  |  รหัสข้อมูลค่าเฉลี่ยอัตราการเต้นของหัวใจ  | int  | 1   |
| bpmAvg  |ค่าเฉลี่ยอัตราการเต้นของหัวใจ  | int  | 52 |   
## การพัฒนาระบบ
### เครื่องมือ
- Arduino UNO+WiFi R3 ATmega328P+ESP8266 บอร์ดที่ในการับ-ส่งข้อมูล
- GY-MAX30102 เซ็นเซอร์วัดอัตราการเต้นของหัวใจ
- OLED เป็นจอแสดงผล

### ภาษาโปรแกรม 
- HTML ใช้ในการขึ้นโครงสร้างหน้าเว็บไซต์
- JavaScript พัฒนาทั้งส่วน Front-end และ Back-end
- C ใช้ในการสั่งการบอร์ดให้ทำการรับ-ส่งข้อมูล
- NodeJS ใช้การพัฒนาในส่วน Back-end
- MQTT เป็นโปรโตคอลที่ใช้ในการส่งข้อมูล

### ไลบรารี
- SparkFun MAX301x Particle Sensor Library เพื่อใช้ในการควบคุมเซ็นเซอร์ MAX3010x
- Adafruit_GFX Library เพื่อสร้างและควบคุมตำแหน่ง, สี, และลักษณะกราฟิกอื่น ๆ บนจอ
- Adafruit_SSD1306 ควบคุมจอแสดงผล OLED รุ่น SSD1306 มีฟังก์ชันที่ช่วยในการแสดงข้อความ, กราฟิก, และตัวเลขต่าง ๆ บนจอ OLED 
- Bootstrap เป็น Framework ที่ใช้สำหรับพัฒนาเว็บไซต์และแอปพลิเคชัน

## การทดสอบ
### สถานการณ์ 1 เมื่อสั่งปิดใช้งานตัวของเซ็นเซอร์ผ่านเว็บไซต์ จอ OLED จะแสดงข้อความว่า Sensor is off
- ผลการทดลอง:
- ![image](https://github.com/jirpathjitpakdee/Project-Iot/assets/68944270/c157a98c-1600-40a6-881f-372c007e9afa/test3.png)
- ![image](https://github.com/jirpathjitpakdee/Project-Iot/assets/68944270/344efbc3-ddc0-4b2c-b784-6d4a10b0be71/test4.png)

### สถานการณ์ 2 เมื่อสั่งเปิดใช้งานตัวของเซ็นเซอร์ผ่านเว็บไซต์ จอ OLED จะแสดงค่าเฉลี่ยอัตราการเต้นของหัวใจขึ้น พร้อมทั้งในหน้าเว็บก็จะแสดงเช่นเดียวกัน
- ผลการทดลอง:
- ![image](https://github.com/jirpathjitpakdee/Project-Iot/assets/68944270/ab3e73aa-4b31-42fa-8921-406bcc6044ee/test5.png)
- ![image](https://github.com/jirpathjitpakdee/Project-Iot/assets/68944270/c51352a9-8153-4cc4-9f6d-fab315a0ae44/test6.png)

## สรุปผลการทดสอบ
โครงงานนี้สามารถควบคุมเซ็นเซอร์ผ่านเว็บไซต์และแสดงสถานะในจอ OLED ตามที่กำหนดไว้ซึ่งสามารถติดตามอัตราการเต้นของหัวใจได้แบบ real-time ช่วยให้การดูแลสุขภาพเป็นไปอย่างมีประสิทธิภาพ
